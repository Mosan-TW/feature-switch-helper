{"version":3,"file":"feature-switch-config.dto.js","sourceRoot":"/","sources":["src/dto/feature-switch-config.dto.ts"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,mBAAmB,CAAA;AAChD,OAAO,EAAE,YAAY,EAAE,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAA;AAEpH,MAAM,OAAO,aAAa;IACxB;;;;OAIG;IAIH,cAAc,GAAY,KAAK,CAAA;IAE/B;;;;OAIG;IAIH,YAAY,GAAY,KAAK,CAAA;IAE7B;;;;OAIG;IAIH,aAAa,GAAY,KAAK,CAAA;IAE9B;;;;OAIG;IAIH,YAAY,GAAY,KAAK,CAAA;IAE7B;;OAEG;IAIH,IAAI,CAAS;CACd;AAvCC;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;qDACkB;AAU/B;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;mDACgB;AAU7B;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;oDACiB;AAU9B;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;mDACgB;AAQ7B;IAHC,MAAM,EAAE;IACR,QAAQ,EAAE;IACV,UAAU,EAAE;;2CACA;AAGf,MAAM,OAAO,iCAAiC;IAC5C;;;;OAIG;IAIH,oCAAoC,GAAY,IAAI,CAAA;IAEpD;;;;OAIG;IAIH,kCAAkC,GAAY,IAAI,CAAA;IAElD;;;;OAIG;IAKH,YAAY,CAAW;CACxB;AAtBC;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;+FACuC;AAUpD;IAHC,MAAM,EAAE;IACR,SAAS,EAAE;IACX,UAAU,EAAE;;6FACqC;AAWlD;IAJC,MAAM,EAAE;IACR,OAAO,EAAE;IACT,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IACxB,YAAY,CAAC,CAAC,CAAC;;uEACO;AAGzB,MAAM,OAAO,sBAAsB;IACjC;;OAEG;IAKH,QAAQ,CAA6B;IAErC;;OAEG;IAKH,iBAAiB,CAAoC;CACtD;AAVC;IAJC,MAAM,EAAE;IACR,IAAI,CAAC,GAAG,EAAE,CAAC,aAAa,CAAC;IACzB,UAAU,CAAC,aAAa,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IACzC,cAAc,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;8BACpB,GAAG;wDAAuB;AASrC;IAJC,MAAM,EAAE;IACR,IAAI,CAAC,GAAG,EAAE,CAAC,iCAAiC,CAAC;IAC7C,UAAU,CAAC,iCAAiC,CAAC;IAC7C,cAAc,EAAE;8BACG,iCAAiC;iEAAA","sourcesContent":["import { Expose, Type } from 'class-transformer'\nimport { ArrayMinSize, IsArray, IsBoolean, IsInstance, IsOptional, IsString, ValidateNested } from 'class-validator'\n\nexport class FeatureDefDto {\n  /**\n   * 是否強制啟用功能\n   *\n   * 若設置為 true，則無論環境如何，功能均被啟用，包含 PRODUCTION 環境！\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  isForceEnabled: boolean = false\n\n  /**\n   * 是否為開發環境專用功能\n   *\n   * 若設置為 true，則該功能僅在開發環境 (development) 中啟用\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  isDevFeature: boolean = false\n\n  /**\n   * 是否為測試環境專用功能\n   *\n   * 若設置為 true，則該功能僅在測試環境 (test) 中啟用\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  isTestFeature: boolean = false\n\n  /**\n   * 是否為 UAT 環境專用功能\n   *\n   * 若設置為 true，則該功能僅在 UAT 環境中啟用\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  isUatFeature: boolean = false\n\n  /**\n   * 功能備註\n   */\n  @Expose()\n  @IsString()\n  @IsOptional()\n  note?: string\n}\n\nexport class FeatureSwitchValidationOptionsDto {\n  /**\n   * 是否禁止使用未定義的功能開關\n   *\n   * 若設置為 true，則在嘗試在程式碼中使用 `isFeatureEnabled` 查詢未在 `feature-switch.json` 中定義的功能開關時，會拋出錯誤！\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  shouldNotUseUndefinedFeatureSwitches: boolean = true\n\n  /**\n   * 是否強制所有在 `feature-switch.json` 中定義的功能開關均被使用\n   *\n   * 若設置為 true，則在驗證階段會檢查所有在 `feature-switch.json` 中定義的功能開關是否至少被使用一次，若有未被使用的功能開關，則會拋出錯誤！\n   */\n  @Expose()\n  @IsBoolean()\n  @IsOptional()\n  shouldUseAllDefinedFeatureSwitches: boolean = true\n\n  /**\n   * 用於驗證的檔案路徑模式\n   *\n   * 通常為一個或多個 glob 模式，用於指定哪些 TypeScript 檔案需要被掃描以驗證功能開關的使用情況\n   */\n  @Expose()\n  @IsArray()\n  @IsString({ each: true })\n  @ArrayMinSize(1)\n  filePatterns!: string[]\n}\n\nexport class FeatureSwitchConfigDto {\n  /**\n   * 功能開關的定義\n   */\n  @Expose()\n  @Type(() => FeatureDefDto)\n  @IsInstance(FeatureDefDto, { each: true })\n  @ValidateNested({ each: true })\n  features!: Map<string, FeatureDefDto>\n\n  /**\n   * 功能開關的驗證選項\n   */\n  @Expose()\n  @Type(() => FeatureSwitchValidationOptionsDto)\n  @IsInstance(FeatureSwitchValidationOptionsDto)\n  @ValidateNested()\n  validationOptions!: FeatureSwitchValidationOptionsDto\n}\n"]}